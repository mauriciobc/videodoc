# videodoc

> Automated documentation video toolkit — Playwright + Remotion, built for reuse across projects.

Capture screenshots of real user journeys with Playwright, then compose them into polished tutorial videos with Remotion. One command regenerates all your documentation assets whenever your UI changes.

---

## How It Works

```
Your App  →  Playwright scripts  →  Screenshots  →  Remotion composition  →  Tutorial video
                (journey scripts)     (assets)          (React code)            (.mp4)
```

1. **Playwright journey scripts** simulate user interactions and capture screenshots at each meaningful step
2. **Remotion compositions** assemble those screenshots into animated, branded tutorial videos
3. A **CLI scaffolder** (`create-videodoc`) sets up everything in any project with one command

---

## Packages

| Package | Description |
|---|---|
| [`@videodoc/core`](./packages/core) | Reusable Remotion components + Playwright helpers |
| [`create-videodoc`](./packages/create-videodoc) | CLI scaffolder — run in any project to get started |

---

## Quick Start

### In a new project

```bash
# Scaffold videodoc into your project
npx create-videodoc init

# Install deps (Playwright + Remotion added automatically)
npm install

# Edit your seed data
# docs-automation/fixtures/seed-data.js

# Write your first journey
# docs-automation/journeys/example-journey.spec.js

# Run screenshots
npm run docs:screenshots

# Preview the video in Remotion Studio
npm run docs:preview

# Render final video
npm run docs:render
```

### Scripts added to your project

| Script | What it does |
|---|---|
| `npm run docs:screenshots` | Runs all Playwright journey scripts → generates screenshots |
| `npm run docs:preview` | Opens Remotion Studio for live composition preview |
| `npm run docs:render` | Renders all compositions to `.mp4` |
| `npm run docs:generate` | Screenshots + render in one command |
| `npm run docs:render:one` | Render a single named composition |

---

## Project Structure (after init)

```
docs-automation/
  playwright.config.js     ← Playwright config for your project
  remotion.config.js       ← Remotion config (fps, resolution)
  theme.js                 ← Brand colors & typography
  Root.jsx                 ← Registers all Remotion compositions
  journeys/
    example-journey.spec.js   ← Playwright journey scripts go here
  compositions/
    ExampleJourney.jsx        ← Remotion compositions go here
  fixtures/
    seed-data.js              ← Realistic test data for every journey
  assets/
    screenshots/              ← Auto-generated by Playwright (gitignore this)
```

---

## Writing a Journey Script

Journey scripts are Playwright tests that tell a visual story. Each `capture()` call is a deliberate documentation decision — you're authoring the visual narrative, not just testing.

```js
// docs-automation/journeys/log-feeding.spec.js
import { test } from '@playwright/test';
import { capture, setupLocalStorageState } from '@videodoc/core/playwright';
import { seedData } from '../fixtures/seed-data.js';

const OUT = (name) => `./docs-output/screenshots/log-feeding/${name}`;

test('Journey: Log a feeding', async ({ page }) => {

  // Seed realistic state
  await page.goto('/');
  await setupLocalStorageState(page, seedData);
  await page.reload({ waitUntil: 'networkidle' });

  // Step 1 — capture what the user sees
  await capture(page, '01-dashboard', OUT('01-dashboard'));

  // Step 2 — perform an action, then capture
  await page.getByTestId('btn-log-feeding').click();
  await page.waitForSelector('[data-testid="feeding-form"]');
  await capture(page, '02-form-open', OUT('02-form-open'));

  // ... continue for each step
});
```

**Tips:**
- Use `data-testid` attributes on key UI elements for stable selectors
- Name screenshots with a number prefix (`01-`, `02-`) so they sort correctly
- Add a comment before each step describing what the user is doing

---

## Writing a Composition

Compositions are React components that assemble screenshots into a video using Remotion's `Sequence` primitive.

```jsx
// docs-automation/compositions/LogFeeding.jsx
import { AbsoluteFill, Sequence } from 'remotion';
import { Intro, Outro, ScreenFrame, Caption, Highlight } from '@videodoc/core';
import { theme } from '../theme.js';

const SS = './assets/screenshots/log-feeding';

export const LogFeeding = () => (
  <AbsoluteFill style={{ background: theme.background }}>

    {/* 0–3s: Intro title card */}
    <Sequence from={0} durationInFrames={90}>
      <Intro title="How to Log a Feeding" appName="Cat Tracker" theme={theme} />
    </Sequence>

    {/* 3–6s: Dashboard */}
    <Sequence from={90} durationInFrames={90}>
      <ScreenFrame src={`${SS}/01-dashboard.png`} theme={theme} />
      <Caption text="Your dashboard shows today's feeding summary." theme={theme} />
    </Sequence>

    {/* 6–9s: Open form — highlight the button */}
    <Sequence from={180} durationInFrames={90}>
      <ScreenFrame src={`${SS}/02-form-open.png`} theme={theme} />
      <Highlight x={320} y={48} width={160} height={44} theme={theme} />
      <Caption text='Tap "Log Feeding" to open the entry form.' theme={theme} />
    </Sequence>

    {/* 9–12s: Outro */}
    <Sequence from={270} durationInFrames={90}>
      <Outro message="You're all set!" theme={theme} />
    </Sequence>

  </AbsoluteFill>
);
```

**Timing reference:** At 30fps, 30 frames = 1 second. 90 frames = 3 seconds per step is a comfortable reading pace.

---

## Available Components

### `<Intro>`
Opening title card with app name, journey title, and description. Animated entrance.

```jsx
<Intro
  appName="My App"
  title="How to Complete This Task"
  description="A short description of what this tutorial covers."
  theme={theme}
/>
```

### `<Outro>`
Closing card with success indicator, message, and optional CTA.

```jsx
<Outro
  message="You're all set!"
  cta="Visit our docs for more tutorials"
  url="docs.myapp.com"
  theme={theme}
/>
```

### `<ScreenFrame>`
Wraps a screenshot in a device frame with entrance animation.

```jsx
<ScreenFrame
  src="./assets/screenshots/01-dashboard.png"
  entrance="fade"       // 'fade' | 'slide-up' | 'zoom' | 'none'
  chrome="browser"      // 'browser' | 'clean' | 'none'
  theme={theme}
/>
```

### `<Caption>`
Animated caption bar, typically at the bottom of the screen.

```jsx
<Caption
  text="This is the dashboard."
  position="bottom"     // 'bottom' | 'top' | 'center'
  theme={theme}
/>
```

### `<Highlight>`
Animated border ring that draws attention to a UI element.
Coordinates are in pixels relative to the composition canvas.

```jsx
<Highlight
  x={320} y={48}
  width={160} height={44}
  animation="pulse"     // 'pulse' | 'draw' | 'fade'
  theme={theme}
/>
```

### `<StepCard>`
Full-screen card for separating major journey sections.

```jsx
<StepCard
  title="Setting Up Your Profile"
  subtitle="This only takes a minute."
  stepNumber="Step 1 of 4"
  theme={theme}
/>
```

### `<ZoomIn>`
Zooms into a specific region of a screenshot to highlight detail.

```jsx
<ZoomIn
  src="./assets/screenshots/01-dashboard.png"
  focusX={0.7}          // 0–1, horizontal center of zoom target
  focusY={0.3}          // 0–1, vertical center of zoom target
  zoomLevel={2.5}
  theme={theme}
/>
```

---

## Theming

Override any token from the default theme in `docs-automation/theme.js`:

```js
import { mergeTheme } from '@videodoc/core';

export const theme = mergeTheme({
  accent: '#e11d48',                         // brand primary
  accentAlt: '#f43f5e',                      // brand secondary
  fontFamily: 'Poppins, sans-serif',
  background: '#0a0a0a',
  stepCardAccent: '#e11d48',
});
```

Full token list with defaults is in `packages/core/src/remotion/theme.js`.

---

## Playwright Helpers

```js
import {
  capture,            // viewport screenshot
  captureFullPage,    // full-page screenshot
  waitAndCapture,     // wait for selector, then capture
  hoverAndCapture,    // hover to trigger hover state, then capture
  setupLocalStorageState,  // inject data into localStorage
  setupApiState,      // seed state via API calls
  resetToFreshState,  // clear localStorage + reload (for onboarding journeys)
  defaultSlowMo,      // 600ms — use in playwright.config.js launchOptions
} from '@videodoc/core/playwright';
```

---

## Rendering a Single Composition

```bash
npm run docs:render:one -- --composition=LogFeeding --output=out/log-feeding.mp4
```

---

## CI/CD Integration

Add to your GitHub Actions workflow to regenerate docs on every deploy:

```yaml
# .github/workflows/docs.yml
name: Generate Documentation Videos

on:
  push:
    branches: [main]

jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: '20' }
      - run: npm ci
      - run: npx playwright install --with-deps chromium
      - run: npm run docs:generate
      - uses: actions/upload-artifact@v4
        with:
          name: documentation-videos
          path: docs-output/
```

---

## License

MIT
